% !TEX root = ./main.tex

\section{Delivery Schedule}\label{sec:delivery}

As described in the end of \cref{sec:project}, the project will be delivered in two stages: \textbf{documenting} and \textbf{pruning}.

Documenting and recording in the first stage as a preperation, and cleaning the codebase in the second stage to make real changes to \images{} ecosystem. With regard to GSoC timeline, \textsf{Phase 1} evaluates the documentation work, and \textsf{Phase 2} and \textsf{Final} evaluations focus on the pruning stage.

\subsection{Documenting}\label{subsec:documentation}

\subsubsection*{Stage Expectations}

The main purpose of this stage is to provide trackable records for the next stage's pruning work. There'll be three types of records: \textbf{ecosystem documentation}, \textbf{developer manual}, and \textbf{RFCs} (Request For Comments). \par

Ecosystem documentation illustrates the scope of image ecosystem and relationships between different relevant packages, it helps users and developers to understand what package belongs to \images{} and what package doesn't. Developer manual consists of style guide and best practice as well as other related community-operating rules, it gives a documented reference to developers to solve potential conflicts. RFCs with detailed list of API changes and porting operation will be proposed as trackable records for the pruning work in next stage. \par

\subsubsection*{Stage Workflow}

From \date{April 22} to \date{June 24}\footnote{Although the coding officially begins from \date{May 27}, the author will start this project when he's available.}, this stage will continue for ten weeks, which will be divided into two periods: \textbf{discussion period} and \textbf{RFC drafting period}. Ideally, this stage ends after the \textsf{Phase 1 Evaluation} with regard to GSoC timeline. However, since a lot of repositories will be involved in this project, which makes the timeline hard to be sticked to, the timeline serves in a flexible way.\par

The discussion period begins from \date{April 22} to \date{June 9} (weeks 1 to 7). In this period the community will share ideas and thoughts on the future of APIs and on best practices. Documenting work will be included in this period as well. The RFC drafting period begins from \date{May 27} to \date{June 23} (weeks 6 to 9), one or more RFCs will be drafted and discussed in this period. Basically, the content of RFCs come from previous discussions. The last week of this stage is used for evaluation, merge and announcement.\par

With a quick discussion among the community, an ecosystem documentation will be add to \repoimagesgithubio{} as soon as possible to reach a consensus on the future of \images{}, this consensus shall be the fundamental principle to all future discussion. Ideally, the current \images{} maintainer, i.e., \timholy, is supposed to participate\footnote{In case of maintainer being busy on other work, the author will draft a document based on his understanding and post it to the maintainer to get a feedback.}.\par

From weeks 1 to 7, many discussions will happen simultaneously in the following way:
\begin{enumerate}
    \item \textbf{Code Review:} dig into source codes of repositories of images ecosystem to find anything that's likely in need of changing. Other mature \langjulia{} packages, and image-processing libraries in other languages such as \reposcikitimage{} and \matlabimageprocessing{} are references.
    \item \textbf{Issue Open:} open an issue for anything that is worth a discussion, e.g., legacy codes, misplaced codes, codes with bad practice, and undocumented practices and decisions.
    \item \textbf{Decision Make:} the purpose of discussion is to make decision on API and practice. The conventional principles are taken: a decision is made when consensus is reached, otherwise the current maintainer of \images{} make the decision. If a decision can't be made before June 16 (Week 8), it'll be dropped as future work.
    \item \textbf{Record:} all approved, rejected and future-work proposals will be documented in a temporary repository - \repogsoctempdoc{}. Developer manual will be drafted to \repoimagesgithubio{} when there're enough decisions made.
\end{enumerate}

From weeks 6 to 9, RFC drafting\footnote{A \href{https://github.com/tensorflow/community/blob/master/rfcs/yyyymmdd-rfc-template.md}{RFC Template} is available in the Tensorflow community, and \href{https://github.com/tensorflow/community/blob/master/rfcs/20180827-api-names.md}{20180827-api-names.md} is a good API-renaming RFC example.} will happen simultaneously in the following way:
\begin{enumerate}
    \item \textbf{Code Review:} for each approved proposal, find all involved code pieces, and give a solution to it according to developer's manual. The principle of code review is to rigorously sticking to decisions made in the discussion period -- either there's one principle or no principle.
    \item \textbf{RFC Post:} post the draft-version of RFC in \repogsoctempdoc{}.
    \item \textbf{Discuss:} if there's any issue with any item in the proposed RFC, suspend the related items and go back to the discussion workflow until a decision is made.
    \item \textbf{Merge and Announcement:} RFCs will be merged to a new folder in \repoimagesgithubio{} and be announced to the community via slack and discourse. RFC merge and announcement will only happen in last two weeks in case there're more items to be added.
\end{enumerate}
RFC details on how codebase is pruned will be in \cref{subsec:prune}.

\subsubsection*{Stage Evaluation}

Four items are evaluated during this stage, i.e., \textsf{Phase 1 Evaluation}:
\begin{itemize}
    \item 2/10: activity on issues and discussions
    \item 2/10: ecosystem documentation
    \item 3/10: developer manual
    \item 3/10: RFCs
\end{itemize}
A score of 6/10 stands for \textsf{Evaluation Pass}.

\subsection{Pruning Codebase}\label{subsec:prune}
After the RFCs being merged and announced to the community, the pruning stage begins.

\subsubsection*{Stage Expectations}

The pruning stage is to clean the codebase according to the RFC operation guide. There'll be three types of pruning work:
\begin{itemize}
    \item symbol renaming, move, and removal
    \item API changes
    \item API enhancement
\end{itemize}
For the ease of tracking the progress, a milestone will be set in \repoimages{} to track the progress, each pruning PR/issue will be assigned a tag. \par

Challenges during this stage are: backward incompatibility, and complex package dependencies. The next section will be strategies to this challenges. \par

\subsubsection*{Stage Workflow}

One principle of the pruning work is to start from packages with the least dependencies to that with the most dependencies. In this project, we do from core packages (e.g., \repoimagecore{}), to application packages (e.g., \repoimagetransformations{}), and finally to the user-entrance package, i.e., \repoimages{}.\par

\ask{Should all the pruning work happen in a seperate branch other than \sname{master} branch?}

\newcommand{\packageA}{package \sname{A}\xspace}
\newcommand{\packageB}{package \sname{B}\xspace}

Porting methods from package \packageA to \packageB takes the following routine:
\begin{enumerate}
    \item implement new methods and unit tests in \packageB, bump a \sname{patch}\footnote{According to \semanticversion{}, \sname{minor} version should be backward compatible. However, in this project, it's not suitable to bump \sname{major} version until all the pruning work is done, hence here we bump \sname{minor} and \sname{patch} version.} version to \packageB,
    \item in \packageA, move methods to a seperate \mintinline{julia}{deprecated.jl} file and deprecate them, bump a \sname{patch} version to \packageA,
    \item wait for one month for exported symbols to give downstream packages time to replace with new symbols,
    \item in \packageA, delete the deprecated files, bump a \sname{minor} version to \packageA
\end{enumerate}
Steps 1-2 will be done as a part of this project, and steps 3-4 will be future work.

\subsubsection*{Stage Evaluation}

With regard to GSoC timeline, this stage includes the \sname{Phase 2} and \sname{Phase final} evaluations. The \sname{Phase 2} evaluation shall focus on checking if the pruning work begins as expected, and the \sname{Phase final} evaluation shall focus on the milestone progress.
